### **第10章：哈希表**

#### **一、核心思想**

- **目标**：实现快速插入和查找，牺牲一定的空间和完美顺序来换取平均接近 O(1) 的时间复杂度。
- **机制**：使用一个**哈希函数**，将任意类型的 **键** 映射到一个固定大小的数组的 **索引** 上，从而直接定位数据。
- **核心比喻**：就像按照咖啡名称（键）直接找到对应的咖啡豆，而不需要按照口味、保质期等其他属性排序。

#### **二、关键组成部分**
1.  **键**：用于唯一标识数据项的值（如咖啡名称、身份证号）。
2.  **哈希函数**：将键映射到数组索引的数学函数。
3.  **哈希表**：存储数据的数组，每个位置称为一个“桶”。

#### **三、哈希冲突**
- **定义**：两个或多个不同的键被哈希函数映射到了同一个桶的情况。
- **必然性**：只要键的空间大于桶的数量，冲突就不可避免。
- **比喻**：会议注册时，所有姓氏首字母为A-D的人（键）都被指引到同一个接待台（桶）前排队。

#### **四、解决冲突的两种主要方法**

| 方法              | 原理                                                         | 优点                                                         | 缺点                                                         |
| :---------------- | :----------------------------------------------------------- | :----------------------------------------------------------- | :----------------------------------------------------------- |
| **1. 链地址法**   | 每个桶不直接存储数据，而是存储一个**链表**的头指针。所有映射到该桶的数据项都存入这个链表中。 | - 实现简单<br>- 适合频繁插入删除<br>- 可存储超过表大小的数据量 | - 需要额外的指针空间（内存开销）<br>- 链表过长时，查找退化为O(n) |
| **2. 线性探测法** | 当目标桶已被占用时，**顺序地**检查下一个桶（通常是索引+1），直到找到空桶或匹配的键为止。 | - 数据连续存储，**缓存友好**<br>- 无额外内存开销（如指针）   | - **聚集现象**：容易形成连续的被占用块，降低查找效率<br>- 删除操作复杂（需特殊标记，不能直接置空） |

#### **五、哈希函数的设计要求**
1.  **确定性**：相同的键必须始终产生相同的哈希值。
2.  **值域可控**：输出范围必须严格在桶的数量范围内（如 `[0, b-1]`）。
3.  **均匀分布**：键应尽可能均匀地映射到所有桶中，以减少冲突。这是衡量哈希函数好坏的关键。

#### **六、字符串哈希方法**

- **简单求和法**：将每个字符的ASCII码相加，然后对桶数取模。
    - **缺点**：不考虑字符顺序，“act”和“cat”会冲突。
- **霍纳法则**：更优的方法。采用一个乘法因子（通常是质数）来加权计算，考虑了字符的顺序。
    - 公式示例：`hash = (hash * CONST + char_value) % size`

#### **七、操作步骤（以查找为例）**
1.  **计算哈希值**：对键应用哈希函数，得到初始索引。
2.  **定位桶**：访问数组中该索引的位置。
3.  **解决冲突**：
    - **链地址法**：遍历该桶对应的链表，比较键值。
    - **线性探测法**：从该索引开始顺序向后查找，直到找到匹配的键或空桶。

#### **八、应用场景**
- **实现高级数据结构**：如Python的字典、集合。
- **图遍历**：在BFS/DFS中，用哈希表高效记录已访问过的节点，避免重复处理和循环。
- **缓存**：快速判断数据是否已在缓存中。
- **负载均衡**：根据请求的某个特征（键）将其哈希到特定的服务器进行处理。

#### **九、总结与权衡**
- **优势**：在理想情况下提供极快的平均访问速度。
- **代价**：
    - **空间**：通常会分配比实际数据量更大的数组以减少冲突。
    - **不确定性**：最坏情况下（所有键冲突）性能会退化为O(n)。
    - **无序性**：不保持数据的任何顺序。
- **核心启示**：哈希表是**“空间换时间”** 和**“数学映射替代显式比较”** 的经典实践，通过结合数组和链表（或探测逻辑）巧妙地平衡了效率与复杂性。
